<!DOCTYPE html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width, initial-scale=1.0"><title>KBFinder</title><link rel=stylesheet href=https://unpkg.com/leaflet/dist/leaflet.css><link rel=stylesheet href=https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.css><link rel=stylesheet href=https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.Default.css><script src=https://unpkg.com/leaflet/dist/leaflet.js></script><script src=https://unpkg.com/leaflet.markercluster/dist/leaflet.markercluster.js></script><script src=https://code.jquery.com/jquery-3.6.0.min.js></script><link href="https://fonts.googleapis.com/css2?family=Be+Vietnam:wght@400;500;600;700&display=swap" rel=stylesheet><link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel=stylesheet><link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" rel=stylesheet><link rel=stylesheet href=https://cdn-uicons.flaticon.com/2.4.0/uicons-regular-straight/css/uicons-regular-straight.css><link rel=stylesheet href=https://cdn-uicons.flaticon.com/2.4.0/uicons-thin-straight/css/uicons-thin-straight.css><link rel=stylesheet href=https://cdn-uicons.flaticon.com/2.4.0/uicons-regular-rounded/css/uicons-regular-rounded.css><link rel=stylesheet href=https://cdn-uicons.flaticon.com/2.4.0/uicons-solid-straight/css/uicons-solid-straight.css><link rel=stylesheet href=https://cdn-uicons.flaticon.com/2.4.0/uicons-solid-rounded/css/uicons-solid-rounded.css><link rel=stylesheet href=https://cdn-uicons.flaticon.com/2.4.2/uicons-thin-rounded/css/uicons-thin-rounded.css><link rel=stylesheet href=https://cdn-uicons.flaticon.com/2.4.2/uicons-regular-straight/css/uicons-regular-straight.css><link rel=stylesheet href=https://cdn-uicons.flaticon.com/2.5.1/uicons-regular-rounded/css/uicons-regular-rounded.css><link rel=stylesheet href=./style.css><link rel=stylesheet href=./favorites.css><link rel=stylesheet href=./morebusinessfilters.css><style>

    </style></head><body><div id=map style="height: 100%;"><div class=filter-container><button class=restaurants-filter><i class="fi fi-rs-cup-straw-swoosh"></i><span class=restaurants-text>Restaurants</span><span class=tooltip-bottom>Show Kakapmpink Restaurants</span></button><button class=cafes-filter><i class="fi fi-rr-coffee"></i><span class=cafes-text>Cafes</span><span class=tooltip-bottom>Show Kakampink Cafes</span></button><button class=milktea-filter><i class="fi fi-rs-cup-straw-swoosh"></i><span class=milktea-text>Milktea</span><span class=tooltip-bottom>Show Kakampink Milktea Shops</span></button><button class=bakeshops-filter><i class="fi fi-rr-cake-slice"></i><span class=bakeshops-text>Bakeshops</span><span class=tooltip-bottom>Show Kakapmpink Bakeshops</span></button><button class=foodbusiness-filter><i class="fi fi-rs-room-service"></i><span class=foodbusiness-text>Food Biz</span><span class=tooltip-bottom>Show Kakampink Food Businesses</span></button><button class=clothesshop-filter><i class="fi fi-rs-tshirt"></i><span class=clotheshop-text>Clothes</span><span class=tooltip-bottom>Show Kakampink Clothing Apparel Shops</span></button><button class=more-filter><i class="fi fi-rr-menu-dots"></i><span class=more-text>More</span><span class=tooltip-bottom>Show more...</span></button></div><div class=more-filters-panel><h4>More Businesses</h4><div class=more-filters-grid><button class="filter-button resort-filter"><i class="fi fi-rs-hotel"></i><i class="fi fi-rs-umbrella-beach"></i><span class=filter-text>Hotels, Resorts, Rentals</span></button><button class="filter-button gift-filter"><i class="fi fi-rs-gift"></i><span class=filter-text>Gifts</span></button><button class="filter-button event-filter"><i class="fi fi-rs-calendar"></i><span class=filter-text>Events</span></button><button class="filter-button pet-filter"><i class="fi fi-rs-paw"></i><span class=filter-text>Pets</span></button><button class="filter-button plant-filter"><i class="fi fi-rs-flower"></i><span class=filter-text>Plants</span></button><button class="filter-button frozen-goods-filter"><i class="fi fi-rs-snowflake"></i><span class=filter-text>Frozen Goods</span></button><button class="filter-button consulting-filter"><i class="fi fi-rs-briefcase"></i><span class=filter-text>Consulting</span></button><button class="filter-button photography-filter"><i class="fi fi-rs-camera"></i><span class=filter-text>Photos and Videos</span></button><button class="filter-button electronics-filter"><i class="fi fi-rs-computer"></i><span class=filter-text>Electronics</span></button><button class="filter-button online-shops-filter"><i class="fi fi-rs-shopping-cart"></i><span class=filter-text>E-commerce</span></button><button class="filter-button travel-agency-filter"><i class="fi fi-rs-plane"></i><span class=filter-text>Travel Agency</span></button><button class="filter-button crochet-filter"><i class="fi fi-ts-knitting"></i><span class=filter-text>Crochet</span></button><button class="filter-button art-supplies-filter"><i class="fi fi-rs-paint-brush"></i><span class=filter-text>Art Supplies</span></button><button class="filter-button groceries-filter"><i class="fi fi-rs-shopping-basket"></i><span class=filter-text>Groceries</span></button><button class="filter-button real-estate-filter"><i class="fi fi-ts-land-location"></i><span class=filter-text>Real Estate</span></button><button class="filter-button book-stores-filter"><i class="fi fi-rs-book"></i><span class=filter-text>Book Stores</span></button><button class="filter-button bags-wallets-shoes-filter"><i class="fi fi-rs-shopping-bag"></i><span class=filter-text>Bags, Wallets, Shoes</span></button><button class="filter-button tattoo-piercings-filter"><i class="fi fi-rs-star"></i><span class=filter-text>Tattoo and Piercings</span></button><button class="filter-button print-shops-filter"><i class="fi fi-rs-print"></i><span class=filter-text>Print Shops</span></button><button class="filter-button auto-mechanic-filter"><i class="fi fi-rs-car"></i><span class=filter-text>Auto and Mechanic Services</span></button><button class="filter-button it-services-filter"><i class="fi fi-rs-laptop"></i><span class=filter-text>IT Services</span></button><button class="filter-button home-improvements-filter"><i class="fi fi-rr-couch"></i><span class=filter-text>Home Improvements</span></button><button class="filter-button health-wellness-filter"><i class="fi fi-rs-heart"></i><span class=filter-text>Health and Wellness</span></button><button class="filter-button school-filter"><i class="fi fi-rs-school"></i><span class=filter-text>School</span></button><button class="filter-button others-filter"><i class="fi fi-rs-apps"></i><span class=filter-text>Others</span></button></div><button id=close-more-filters aria-label=Close><i class="fi fi-rr-cross"></i></button></div><div id=more-filters-slide-up-panel class=more-filters-slide-up-panel><div class=panel-handle></div><h4>More Businesses</h4><button id=close-more-filters-mobile aria-label=Close><i class="fi fi-rr-cross"></i></button><div class=more-filters-panel-content><button class="filter-button resort-filter"><i class="fi fi-rs-hotel"></i><i class="fi fi-rs-umbrella-beach"></i><span class=filter-text>Hotels, Resorts, Rentals</span></button><button class="filter-button gift-filter"><i class="fi fi-rs-gift"></i><span class=filter-text>Gifts</span></button><button class="filter-button event-filter"><i class="fi fi-rs-calendar"></i><span class=filter-text>Events</span></button><button class="filter-button pet-filter"><i class="fi fi-rs-paw"></i><span class=filter-text>Pets</span></button><button class="filter-button plant-filter"><i class="fi fi-rs-flower"></i><span class=filter-text>Plants</span></button><button class="filter-button frozen-goods-filter"><i class="fi fi-rs-snowflake"></i><span class=filter-text>Frozen Goods</span></button><button class="filter-button consulting-filter"><i class="fi fi-rs-briefcase"></i><span class=filter-text>Consulting</span></button><button class="filter-button photography-filter"><i class="fi fi-rs-camera"></i><span class=filter-text>Photos and Videos</span></button><button class="filter-button electronics-filter"><i class="fi fi-rs-computer"></i><span class=filter-text>Electronics</span></button><button class="filter-button online-shops-filter"><i class="fi fi-rs-shopping-cart"></i><span class=filter-text>E-commerce</span></button><button class="filter-button travel-agency-filter"><i class="fi fi-rs-plane"></i><span class=filter-text>Travel Agency</span></button><button class="filter-button crochet-filter"><i class="fi fi-ts-knitting"></i><span class=filter-text>Crochet</span></button><button class="filter-button art-supplies-filter"><i class="fi fi-rs-paint-brush"></i><span class=filter-text>Art Supplies</span></button><button class="filter-button groceries-filter"><i class="fi fi-rs-shopping-basket"></i><span class=filter-text>Groceries</span></button><button class="filter-button real-estate-filter"><i class="fi fi-ts-land-location"></i><span class=filter-text>Real Estate</span></button><button class="filter-button book-stores-filter"><i class="fi fi-rs-book"></i><span class=filter-text>Book Stores</span></button><button class="filter-button bags-wallets-shoes-filter"><i class="fi fi-rs-shopping-bag"></i><span class=filter-text>Bags, Wallets, Shoes</span></button><button class="filter-button tattoo-piercings-filter"><i class="fi fi-rs-star"></i><span class=filter-text>Tattoo and Piercings</span></button><button class="filter-button print-shops-filter"><i class="fi fi-rs-print"></i><span class=filter-text>Print Shops</span></button><button class="filter-button auto-mechanic-filter"><i class="fi fi-rs-car"></i><span class=filter-text>Auto and Mechanic Services</span></button><button class="filter-button it-services-filter"><i class="fi fi-rs-laptop"></i><span class=filter-text>IT Services</span></button><button class="filter-button home-improvements-filter"><i class="fi fi-rr-couch"></i><span class=filter-text>Home Improvements</span></button><button class="filter-button health-wellness-filter"><i class="fi fi-rs-heart"></i><span class=filter-text>Health and Wellness</span></button><button class="filter-button school-filter"><i class="fi fi-rs-school"></i><span class=filter-text>School</span></button><button class="filter-button others-filter"><i class="fi fi-rs-apps"></i><span class=filter-text>Others</span></button></div></div></div><div id=slide-up-panel class=slide-up-panel><div class=panel-handle></div><div class=panel-content></div></div><div id=favorites><button id=close-favorites aria-label=Close style="background: none; border: none; cursor: pointer; position: absolute; top: 10px; right: 10px;"><i class="fi fi-rr-cross" style="font-size: 13px;"></i></button><div style="padding: 15px;"><h4 style="margin-top: 0; font-family: 'Be Vietnam', sans-serif; font-size: 18px;">Favorites</h4><div id=favorites-list></div></div></div><div id=favorites-slide-up-panel class=favorites-slide-up-panel><div class=panel-handle></div><h4>Favorites</h4><div class=favorites-panel-content></div></div><button class=userlocation-button onclick=locateUser()><i class="fi fi-rr-location-crosshairs"></i><span class=tooltip-right>Locate User</span></button><div class=menu-bar><div class=left-section><div class=project-title><span>KBFinder (Beta)</span></div></div><div class=middle-section></div><div class=right-section><div class=search-bar><input type=text id=searchInput placeholder="Search Pink Businesses..."><button id=searchButton style="color: #919191;"><span class=material-symbols-outlined>search</span></button><button id=favoriteButton style="background: none; border: none; cursor: pointer;"><i class="fi fi-ss-heart" style="font-size: 24px;"></i></button></div></div></div><div id=slideMenu class=slide-menu><div class=slide-menu-content><span class="material-icons-outlined slide-menu-close" onclick=toggleSlideMenu()>close</span><div class=filter-category style="font-size: 12px;"><span class=filter-title style="display: flex; align-items: center;"><span class=material-symbols-outlined style="margin-right: 5px;">category</span><span style="padding-right: 10px;">Select Project Category</span><span style="flex-grow: 1;"></span><button class=clear-categorySelection-button onclick=clearCategorySelection()>Clear Selection</button></span><div><div class=checkbox-container><span class=label-text>Food and Beverage</span><label><input type=checkbox name=category value="Food and Beverage" style="margin-right: 5px;" onclick=toggleFoodAndBeverageOptions()><span class=checkmark></span></label><span class="material-symbols-outlined food-and-beverage-expand-icon expand-icon" onclick="toggleOptions('foodAndBeverageOptions', '.food-and-beverage-expand-icon')" style="margin-left: 5px;">expand_more</span></div><div id=foodAndBeverageOptions class=expandable-options style="max-height: 0px; margin-left: 20px;"><div class=checkbox-container><span class=label-text>Food Business/Home Cook/Snack</span><label><input type=checkbox name=category value=food_business__homecook__snack onclick=toggleFoodAndBeverageCheckbox()><span class=checkmark></span></label></div><div class=checkbox-container><span class=label-text>Coffee Shops</span><label><input type=checkbox name=category value=coffee_shops onclick=toggleFoodAndBeverageCheckbox()><span class=checkmark></span></label></div><div class=checkbox-container><span class=label-text>Milk Tea</span><label><input type=checkbox name=category value=milk_tea onclick=toggleFoodAndBeverageCheckbox()><span class=checkmark></span></label></div><div class=checkbox-container><span class=label-text>Restaurants</span><label><input type=checkbox name=category value=restaurants onclick=toggleFoodAndBeverageCheckbox()><span class=checkmark></span></label></div><div class=checkbox-container><span class=label-text>Bakeshop</span><label><input type=checkbox name=category value=bakeshop onclick=toggleFoodAndBeverageCheckbox()><span class=checkmark></span></label></div><div class=checkbox-container><span class=label-text>Liquors and Spirits</span><label><input type=checkbox name=category value=liquors_and_spirits onclick=toggleFoodAndBeverageCheckbox()><span class=checkmark></span></label></div><div class=checkbox-container><span class=label-text>Frozen Goods</span><label><input type=checkbox name=category value=frozen_goods onclick=toggleFoodAndBeverageCheckbox()><span class=checkmark></span></label></div><div class=checkbox-container><span class=label-text>Groceries</span><label><input type=checkbox name=category value=groceries onclick=toggleFoodAndBeverageCheckbox()><span class=checkmark></span></label></div></div><div class=checkbox-container><span class=label-text>Retail</span><label><input type=checkbox name=category value=Retail style="margin-right: 5px;" onclick=toggleRetailOptions()><span class=checkmark></span></label><span class="material-symbols-outlined retail-expand-icon expand-icon" onclick="toggleOptions('retailOptions', '.retail-expand-icon')" style="margin-left: 5px;">expand_more</span></div><div id=retailOptions class=expandable-options style="max-height: 0px; margin-left: 20px;"><div class=checkbox-container><span class=label-text>Flowers and Plant Shops</span><label><input type=checkbox name=category value="Flowers and Plant Shops" onclick=toggleRetailCheckbox()><span class=checkmark></span></label></div><div class=checkbox-container><span class=label-text>Clothes Shop</span><label><input type=checkbox name=category value="Clothes Shop" onclick=toggleRetailCheckbox()><span class=checkmark></span></label></div><div class=checkbox-container><span class=label-text>Dry Goods/Bags/Wallets/Shoe</span><label><input type=checkbox name=category value="Dry Goods/Bags/Wallets/Shoe" onclick=toggleRetailCheckbox()><span class=checkmark></span></label></div><div class=checkbox-container><span class=label-text>Book Store</span><label><input type=checkbox name=category value="Book Store" onclick=toggleRetailCheckbox()><span class=checkmark></span></label></div><div class=checkbox-container><span class=label-text>Personalized Gifts/Accessories</span><label><input type=checkbox name=category value="Personalized Gifts/Accessories" onclick=toggleRetailCheckbox()><span class=checkmark></span></label></div><div class=checkbox-container><span class=label-text>Kpop Merchandise</span><label><input type=checkbox name=category value="Kpop Merchandise" onclick=toggleRetailCheckbox()><span class=checkmark></span></label></div></div><div class=checkbox-container><span class=label-text>Services</span><label><input type=checkbox name=category value=Services style="margin-right: 5px;" onclick=toggleServicesOptions()><span class=checkmark></span></label><span class="material-symbols-outlined services-expand-icon expand-icon" onclick="toggleOptions('servicesOptions', '.services-expand-icon')" style="margin-left: 5px;">expand_more</span></div><div id=servicesOptions class=expandable-options style="max-height: 0px; margin-left: 20px;"><div class=checkbox-container><span class=label-text>Architecture and Engineering Services</span><label><input type=checkbox name=category value="Architecture and Engineering Services" onclick=toggleServicesCheckbox()><span class=checkmark></span></label></div><div class=checkbox-container><span class=label-text>Travel Agency</span><label><input type=checkbox name=category value="Travel Agency" onclick=toggleServicesCheckbox()><span class=checkmark></span></label></div><div class=checkbox-container><span class=label-text>Salon</span><label><input type=checkbox name=category value=Salon onclick=toggleServicesCheckbox()><span class=checkmark></span></label></div><div class=checkbox-container><span class=label-text>IT Services/Outsourcing</span><label><input type=checkbox name=category value="IT Services/Outsourcing" onclick=toggleServicesCheckbox()><span class=checkmark></span></label></div><div class=checkbox-container><span class=label-text>Consulting Services</span><label><input type=checkbox name=category value="Consulting Services" onclick=toggleServicesCheckbox()><span class=checkmark></span></label></div><div class=checkbox-container><span class=label-text>Pest Control</span><label><input type=checkbox name=category value="Pest Control" onclick=toggleServicesCheckbox()><span class=checkmark></span></label></div><div class=checkbox-container><span class=label-text>Tutorial Centers</span><label><input type=checkbox name=category value="Tutorial Centers" onclick=toggleServicesCheckbox()><span class=checkmark></span></label></div><div class=checkbox-container><span class=label-text>Dental Clinic</span><label><input type=checkbox name=category value="Dental Clinic" onclick=toggleServicesCheckbox()><span class=checkmark></span></label></div><div class=checkbox-container><span class=label-text>Print Shops</span><label><input type=checkbox name=category value="Print Shops" onclick=toggleServicesCheckbox()><span class=checkmark></span></label></div><div class=checkbox-container><span class=label-text>Auto and Mechanic Services</span><label><input type=checkbox name=category value="Auto and Mechanic Services" onclick=toggleServicesCheckbox()><span class=checkmark></span></label></div><div class=checkbox-container><span class=label-text>Home Improvements/Decors/Furniture</span><label><input type=checkbox name=category value="Home Improvements/Decors/Furniture" onclick=toggleServicesCheckbox()><span class=checkmark></span></label></div><div class=checkbox-container><span class=label-text>Photography/Videography/Editing</span><label><input type=checkbox name=category value=Photography/Videography/Editing onclick=toggleServicesCheckbox()><span class=checkmark></span></label></div><div class=checkbox-container><span class=label-text>Events/Weddings/Parties and more</span><label><input type=checkbox name=category value="Events/Weddings/Parties and more" onclick=toggleServicesCheckbox()><span class=checkmark></span></label></div></div><div class=checkbox-container><span class=label-text>Hospitality</span><label><input type=checkbox name=category value=Hospitality style="margin-right: 5px;" onclick=toggleHospitalityOptions()><span class=checkmark></span></label><span class="material-symbols-outlined hospitality-expand-icon expand-icon" onclick="toggleOptions('hospitalityOptions', '.hospitality-expand-icon')" style="margin-left: 5px;">expand_more</span></div><div id=hospitalityOptions class=expandable-options style="max-height: 0px; margin-left: 20px;"><div class=checkbox-container><span class=label-text>Resorts</span><label><input type=checkbox name=category value=Resorts onclick=toggleHospitalityCheckbox()><span class=checkmark></span></label></div></div><div class=checkbox-container><span class=label-text>Real Estate</span><label><input type=checkbox name=category value="Real Estate" style="margin-right: 5px;" onclick=toggleRealEstateOptions()><span class=checkmark></span></label><span class="material-symbols-outlined real-estate-expand-icon expand-icon" onclick="toggleOptions('realEstateOptions', '.real-estate-expand-icon')" style="margin-left: 5px;">expand_more</span></div><div id=realEstateOptions class=expandable-options style="max-height: 0px; margin-left: 20px;"><div class=checkbox-container><span class=label-text>Real Estate</span><label><input type=checkbox name=category value=real_estate onclick=toggleRealEstateCheckbox()><span class=checkmark></span></label></div></div><div class=checkbox-container><span class=label-text>Arts and Entertainment</span><label><input type=checkbox name=category value="Arts and Entertainment" style="margin-right: 5px;" onclick=toggleArtsEntertainmentOptions()><span class=checkmark></span></label><span class="material-symbols-outlined arts-entertainment-expand-icon expand-icon" onclick="toggleOptions('artsEntertainmentOptions', '.arts-entertainment-expand-icon')" style="margin-left: 5px;">expand_more</span></div><div id=artsEntertainmentOptions class=expandable-options style="max-height: 0px; margin-left: 20px;"><div class=checkbox-container><span class=label-text>Arts and Music</span><label><input type=checkbox name=category value="Arts and Music" onclick=toggleArtsEntertainmentCheckbox()><span class=checkmark></span></label></div><div class=checkbox-container><span class=label-text>Tattoo and Piercings</span><label><input type=checkbox name=category value="Tattoo and Piercings" onclick=toggleArtsEntertainmentCheckbox()><span class=checkmark></span></label></div><div class=checkbox-container><span class=label-text>Art Supplies</span><label><input type=checkbox name=category value="Art Supplies" onclick=toggleArtsEntertainmentCheckbox()><span class=checkmark></span></label></div></div><div class=checkbox-container><span class=label-text>Online Retail</span><label><input type=checkbox name=category value="Online Retail" style="margin-right: 5px;" onclick=toggleOnlineRetailOptions()><span class=checkmark></span></label><span class="material-symbols-outlined online-retail-expand-icon expand-icon" onclick="toggleOptions('onlineRetailOptions', '.online-retail-expand-icon')" style="margin-left: 5px;">expand_more</span></div><div id=onlineRetailOptions class=expandable-options style="max-height: 0px; margin-left: 20px;"><div class=checkbox-container><span class=label-text>Shopee Lazada Online Store</span><label><input type=checkbox name=category value="Shopee Lazada Online Store" onclick=toggleOnlineRetailCheckbox()><span class=checkmark></span></label></div></div><div class=checkbox-container><span class=label-text>Home Services</span><label><input type=checkbox name=category value="Home Services" style="margin-right: 5px;" onclick=toggleHomeServicesOptions()><span class=checkmark></span></label><span class="material-symbols-outlined home-services-expand-icon expand-icon" onclick="toggleOptions('homeServicesOptions', '.home-services-expand-icon')" style="margin-left: 5px;">expand_more</span></div><div id=homeServicesOptions class=expandable-options style="max-height: 0px; margin-left: 20px;"><div class=checkbox-container><span class=label-text>Water Refilling Station</span><label><input type=checkbox name=category value="Water Refilling Station" onclick=toggleHomeServicesCheckbox()><span class=checkmark></span></label></div><div class=checkbox-container><span class=label-text>Laundry</span><label><input type=checkbox name=category value=Laundry onclick=toggleHomeServicesCheckbox()><span class=checkmark></span></label></div><div class=checkbox-container><span class=label-text>Construction Supplies</span><label><input type=checkbox name=category value="Construction Supplies" onclick=toggleHomeServicesCheckbox()><span class=checkmark></span></label></div><div class=checkbox-container><span class=label-text>Crochet Products</span><label><input type=checkbox name=category value="Crochet Products" onclick=toggleHomeServicesCheckbox()><span class=checkmark></span></label></div></div><div class=checkbox-container><span class=label-text>Miscellaneous</span><label><input type=checkbox name=category value=Miscellaneous style="margin-right: 5px;" onclick=toggleMiscellaneousOptions()><span class=checkmark></span></label><span class="material-symbols-outlined miscellaneous-expand-icon expand-icon" onclick="toggleOptions('miscellaneousOptions', '.miscellaneous-expand-icon')" style="margin-left: 5px;">expand_more</span></div><div id=miscellaneousOptions class=expandable-options style="max-height: 0px; margin-left: 20px;"><div class=checkbox-container><span class=label-text>School</span><label><input type=checkbox name=category value=School onclick=toggleMiscellaneousCheckbox()><span class=checkmark></span></label></div><div class=checkbox-container><span class=label-text>Farms/Agriculture/Livestock</span><label><input type=checkbox name=category value=Farms/Agriculture/Livestock onclick=toggleMiscellaneousCheckbox()><span class=checkmark></span></label></div><div class=checkbox-container><span class=label-text>Others</span><label><input type=checkbox name=category value=Others onclick=toggleMiscellaneousCheckbox()><span class=checkmark></span></label></div><div class=checkbox-container><span class=label-text>Pet Shops</span><label><input type=checkbox name=category value="Pet Shops" onclick=toggleMiscellaneousCheckbox()><span class=checkmark></span></label></div><div class=checkbox-container><span class=label-text>Electronics</span><label><input type=checkbox name=category value=Electronics onclick=toggleMiscellaneousCheckbox()><span class=checkmark></span></label></div><div class=checkbox-container><span class=label-text>Bike Shop</span><label><input type=checkbox name=category value="Bike Shop" onclick=toggleMiscellaneousCheckbox()><span class=checkmark></span></label></div></div><br><div class=button-container><button class=reset-filters-button><span class=material-symbols-outlined>restart_alt</span> Reset </button><button class=apply-filters-button><span class=material-symbols-outlined>play_arrow</span> Apply Filters </button></div><p></p><div id=resultCount style="display: none; font-size: 12px; font-weight: bold;"></div><div id=noResultsMessage style="display: none; color: red; font-size: 12px; font-weight: bold;"> No results found. Please adjust your filters. </div></div><br><br></div><script src=exportKBFinder.js></script><script src=search.js></script><script src=filterkakampinkbusinesses.js></script><script src=userlocation.js></script><script src=favorites.js></script><script>
                // Initialize the Leaflet map
                const map = L.map('map', {
                    zoomControl: false  // This line disables the zoom control
                }).setView([0, 0], 2);

                // Define tile layers
                const satellite = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
                    attribution: 'Imagery &copy; <a href="https://www.esri.com/">Esri</a>',
                    maxZoom: 18,
                });

                const street = L.tileLayer('https://api.maptiler.com/maps/topo-v2/256/{z}/{x}/{y}@2x.png?key=ygYhKJ5CVp94V87ZZ49x', {
                    attribution: 'Map data &copy; <a href="https://www.maptiler.com/">MapTiler</a> contributors',
                    maxZoom: 28,
                });

                // Define basemap layers object
                const basemaps = {
                    "Satellite Imagery": satellite,
                    "Street": street
                };

                // Add the default tile layer to the map
                street.addTo(map);

                // Function to toggle basemap
                function toggleBasemap() {
                    if (map.hasLayer(street)) {
                        map.removeLayer(street);
                        satellite.addTo(map);
                    } else {
                        map.removeLayer(satellite);
                        street.addTo(map);
                    }
                }

                // Custom control with the image
                const customControl = L.control({ position: 'bottomleft' });

                customControl.onAdd = function (map) {
                    const container = L.DomUtil.create('div', 'basemap-control');

                    const img = L.DomUtil.create('img', 'basemap-image', container);
                    img.src = 'https://i.ibb.co/fHNQYvD/imagery.png';
                    img.alt = 'Basemap Imagery';

                    const label = L.DomUtil.create('div', 'basemap-label', container);
                    label.textContent = 'Imagery';

                    img.onclick = function () {
                        toggleBasemap();
                        if (map.hasLayer(street)) {
                            img.src = 'https://i.ibb.co/j4TfkcV/street.png';
                            label.textContent = 'Street';
                        } else {
                            img.src = 'https://i.ibb.co/fHNQYvD/imagery.png';
                            label.textContent = 'Imagery';
                        }
                    };

                    return container;
                };

                customControl.addTo(map);

                // Custom icon for markers
                const customIcon = L.icon({
                    iconUrl: 'https://i.ibb.co/gWyRjHP/icons8-pin-96-xxhdpi.png',
                    iconSize: [32, 32],
                    iconAnchor: [16, 32],
                    popupAnchor: [0, -32]
                });

                // Create a MarkerClusterGroup
                const markers = L.markerClusterGroup();



                //Grab facebook profile photos from Facebook Graph API
                function getFacebookProfilePicUrl(facebookPageUrl) {
                    if (!facebookPageUrl) return 'https://placehold.co/100x100?text=No+Image';

                    const cleanUrl = facebookPageUrl.split('?')[0].replace(/\/$/, '');
                    const pageIdMatch = cleanUrl.match(/facebook\.com\/(?:pages\/)?(?:[\w-]+\/)?([\w.-]+)$/);
                    const pageIdentifier = pageIdMatch ? pageIdMatch[1] : null;

                    if (pageIdentifier) {
                        return `https://graph.facebook.com/${pageIdentifier}/picture?type=large`;
                    }

                    return 'https://placehold.co/100x100?text=No+Image';
                }

                function generatePopupContent(item) {
                    const businessName = item["results.Business_Name"];
                    const heartColor = window.favorites.getHeartStatus(businessName);

                    // Get the Facebook profile picture URL
                    const profilePicUrl = item["results.Facebook_Page_URL"]
                        ? getFacebookProfilePicUrl(item["results.Facebook_Page_URL"])
                        : 'https://placehold.co/100x100?text=No+Image';

                    let popupContent = `
    <div class="popup-content">
        <div style="display: flex; align-items: center; margin-bottom: 10px;">
            <div style="position: relative; margin-right: 10px;">
                <img src="${profilePicUrl}" alt="${businessName} logo" class="profile-pic" 
                     style="width:50px; height:50px; object-fit:cover; border-radius:50%; cursor: pointer;"
                     onerror="this.onerror=null; this.src='https://placehold.co/100x100?text=No+Image';">
                <div class="profile-pic-preview" style="display: none; position: absolute; top: -100px; left: 30px; z-index: 1000; box-shadow: 0 0 10px rgba(0,0,0,0.5); transition: all 0.3s ease; pointer-events: none;">
                    <img src="${profilePicUrl}" alt="${businessName} logo preview" 
                         style="width:200px; height:200px; object-fit:cover;"
                         onerror="this.onerror=null; this.src='https://placehold.co/200x200?text=No+Image';">
                </div>
            </div>
            <h4 style='font-size: 20px; text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.4);'>${businessName}</h4>
            <i class="fi fi-ss-heart" style="color: ${heartColor}; margin-left: 5px; cursor: pointer;"></i>
        </div>`;

                    if (item["results.What_products_are_yo_r_services_you_offer"]) {
                        popupContent += `<b>Products or Services:</b> ${item["results.What_products_are_yo_r_services_you_offer"]}<br>`;
                    }

                    //if (item["results.Others_iba_pa"]) {
                    //  popupContent += `<b>Others:</b> ${item["results.Others_iba_pa"]}<br>`;
                    //}

                    popupContent += `<b>Address:</b> ${item["results.Address"]}<br>` +
                        `<b>Contact Number:</b> ${item["results.Contact_number"]}<br>` +
                        `<div class='button-container'>`;

                    const buttons = [
                        { icon: "<img src='https://i.ibb.co/T2rDZmc/icons8-phone-50.png' alt='Phone'>", url: `tel:${item["results.Contact_number"]}`, color: "#4caf50", tooltip: "Phone" },
                        { icon: "<img src='https://i.ibb.co/pzS2tMV/icons8-website-50.png' alt='Website'>", url: item["results.Website_or_Online_Shop_Link"], color: "#4caf50", tooltip: "Website" },
                        { icon: "<img src='https://i.ibb.co/QYzfr5X/icons8-facebook-50.png' alt='Facebook'>", url: item["results.Facebook_Page_URL"], color: "#3b5998", tooltip: "Facebook" },
                        { icon: "<img src='https://i.ibb.co/T0s5JyK/icons8-messenger-50.png' alt='Messenger'>", url: item["Facebook Messenger"], color: "#0084ff", tooltip: "Messenger" },
                        { icon: "<img src='https://i.ibb.co/jk7dhy0/icons8-google-maps-50.png' alt='Google Maps'>", url: item["Google Maps"], color: "#4285f4", tooltip: "Google Maps" },
                        { icon: "<img src='https://i.ibb.co/NWqQ2mT/icons8-waze-50.png' alt='Waze'>", url: item["Waze"], color: "#ff9800", tooltip: "Waze" }
                    ];

                    buttons.forEach(button => {
                        if (button.url) {
                            popupContent += `<div class='button' style='background-color:${button.color};'><a href='${button.url}' target='_blank' style='display: flex; align-items: center; justify-content: center; text-decoration: none; color: white; width: 100%; height: 100%; position: relative;'>${button.icon}<span class='tooltip'>${button.tooltip}</span></a></div>`;
                        }
                    });

                    popupContent += `</div></div>`;

                    // Add CSS for hover effect
                    popupContent += `
    <style>
    .profile-pic:hover + .profile-pic-preview {
        display: block !important;
    }
    </style>`;

                    return popupContent;
                }

                // Function to add markers to the map
                function addMarkers(data) {
                    markers.clearLayers(); // Clear existing markers

                    data.forEach(item => {
                        const lat = parseFloat(item["results._geolocation.1"]);
                        const lng = parseFloat(item["results._geolocation.2"]);
                        const businessName = item["results.Business_Name"];

                        if (!isNaN(lat) && !isNaN(lng)) {
                            const popupContent = generatePopupContent(item);

                            const marker = L.marker([lat, lng], { icon: customIcon })
                                .bindTooltip(businessName, {
                                    permanent: true,
                                    direction: 'right',
                                    offset: [10, -15],
                                    className: 'custom-tooltip'
                                });

                            if (window.innerWidth > 768) {
                                marker.bindPopup(popupContent);

                                // Attach event listener for heart icon within the popup
                                marker.on('popupopen', () => {
                                    const heartIcon = document.querySelector('.fi-ss-heart');
                                    if (heartIcon) {
                                        heartIcon.style.color = window.favorites.getHeartStatus(businessName);

                                        heartIcon.addEventListener('click', function () {
                                            window.favorites.toggleHeartStatus(businessName, item["Business Categories"]);
                                            heartIcon.style.color = window.favorites.getHeartStatus(businessName);
                                        });
                                    }
                                });
                            } else {
                                marker.on('click', function () {
                                    showSlideUpPanel(popupContent, businessName, item["Business Categories"]);
                                });
                            }

                            markers.addLayer(marker);
                        }
                    });

                    map.addLayer(markers);
                    window.favorites.updateFavoritesList();
                }


                function showSlideUpPanel(content, businessName, businessCategory) {
                    const panel = document.getElementById('slide-up-panel');
                    panel.innerHTML = `
        <div class="panel-handle"></div>
        <div class="panel-content">
            ${content}
        </div>
    `;
                    panel.classList.add('active');

                    // Add event listener for the heart icon in the slide-up panel
                    const heartIcon = panel.querySelector('.fi-ss-heart');
                    if (heartIcon) {
                        heartIcon.style.color = window.favorites.getHeartStatus(businessName);
                        heartIcon.addEventListener('click', function () {
                            window.favorites.toggleHeartStatus(businessName, businessCategory);
                            this.style.color = window.favorites.getHeartStatus(businessName);
                        });
                    }
                }


                window.flyToMarker = function (businessName) {
                    markers.eachLayer(marker => {
                        if (marker.getTooltip().getContent() === businessName) {
                            marker.openPopup();
                            map.flyTo(marker.getLatLng(), 15);
                        }
                    });
                };

                // Add all markers initially
                addMarkers(data);





                // Initialize favorites functionality
                document.addEventListener("DOMContentLoaded", function () {
                    window.favorites.initializeFavorites();
                });


                window.addEventListener('resize', function () {
                    const isMobile = window.innerWidth <= 768;
                    markers.eachLayer(function (marker) {
                        if (isMobile) {
                            marker.closePopup();
                            marker.unbindPopup();
                        } else {
                            if (!marker.getPopup()) {
                                const content = generatePopupContent(marker.options.item);
                                marker.bindPopup(content.popupContent);
                            }
                        }
                    });
                });

                document.addEventListener('DOMContentLoaded', function () {
                    const panel = document.getElementById('slide-up-panel');

                    panel.addEventListener('click', function (e) {
                        if (e.target === this || e.target.classList.contains('panel-handle')) {
                            this.classList.remove('active');
                        }
                    });
                });




            </script></body></html>